<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Retro Games Library</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(180deg, #0a0a0a 0%, #1a1a1a 100%);
      color: #fff;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      text-align: center;
      padding: 20px 10px;
      background: #111;
      box-shadow: 0 2px 10px rgba(0,0,0,0.5);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    header h1 {
      font-size: 1.8em;
      margin: 0;
      color: #00aaff;
    }

    .filters {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 10px;
      flex-wrap: wrap;
    }

    .filters input, .filters select {
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      font-size: 1em;
      outline: none;
      background: #222;
      color: #fff;
    }

    #gameList {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 20px;
      padding: 20px;
      flex: 1;
    }

    .game-card {
      background: #111;
      border-radius: 12px;
      overflow: hidden;
      text-align: center;
      transition: transform 0.25s ease, box-shadow 0.25s ease;
      cursor: pointer;
      box-shadow: 0 0 8px rgba(0,0,0,0.4);
    }

    .game-card:hover {
      transform: scale(1.05);
      box-shadow: 0 0 20px rgba(0,170,255,0.4);
    }

    .game-cover {
      width: 100%;
      height: 100px;
      object-fit: contain;
      background: #000;
      padding: 10px;
    }

    .game-title {
      font-size: 1em;
      padding: 10px 5px 0;
      font-weight: bold;
      color: #fff;
      height: 40px;
      overflow: hidden;
    }

    .game-system {
      font-size: 0.9em;
      color: #aaa;
      padding-bottom: 10px;
    }

    footer {
      text-align: center;
      padding: 10px;
      font-size: 0.8em;
      background: #111;
      color: #666;
    }

    @media (min-width: 1200px) {
      .game-cover {
        height: 120px;
      }
    }
  </style>
</head>
<body>

  <header>
    <h1>ðŸŽ® Retro Games Library</h1>
    <div class="filters">
      <input type="text" id="search" placeholder="Cerca un gioco...">
      <select id="systemFilter">
        <option value="">Tutte le console</option>
        <option value="GBA">Game Boy Advance</option>
        <option value="GBC">Game Boy Color</option>
        <option value="GB">Game Boy</option>
      </select>
    </div>
  </header>

  <main id="gameList"></main>

  <footer>Â© 2025 Retro Emulator Project</footer>

  <script>
    async function loadGames() {
      try {
        const res = await fetch('games.json');
        const games = await res.json();
        return games.filter(g => g && g.title && g.system && g.rom);
      } catch (err) {
        console.error('Errore nel caricamento di games.json:', err);
        return [];
      }
    }

    function getSystemLogo(system) {
      switch (system.toUpperCase()) {
        case 'GBA':
          return 'https://upload.wikimedia.org/wikipedia/commons/5/50/Game_Boy_Advance_logo.svg';
        case 'GBC':
          return 'https://upload.wikimedia.org/wikipedia/commons/c/c5/Game_Boy_Color_logo.svg';
        case 'GB':
          return 'https://upload.wikimedia.org/wikipedia/commons/f/f2/Nintendo_Game_Boy_Logo.svg';
        default:
          return 'https://upload.wikimedia.org/wikipedia/commons/5/50/Game_Boy_Advance_logo.svg';
      }
    }

    function createGameCard(game) {
      const card = document.createElement('div');
      card.className = 'game-card';
      card.innerHTML = `
        <img src="${getSystemLogo(game.system)}" alt="${game.system}" class="game-cover">
        <div class="game-title">${game.title}</div>
        <div class="game-system">${game.system}</div>
      `;
      card.onclick = () => {
        window.location.href = `play.html?rom=${encodeURIComponent(game.rom)}&title=${encodeURIComponent(game.title)}`;
      };
      return card;
    }

    function renderGames(games) {
      const container = document.getElementById('gameList');
      container.innerHTML = '';
      if (games.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#888;">Nessun gioco trovato.</p>';
        return;
      }
      games.forEach(game => container.appendChild(createGameCard(game)));
    }

    async function init() {
      const allGames = await loadGames();
      const searchInput = document.getElementById('search');
      const filterSelect = document.getElementById('systemFilter');

      function updateList() {
        const search = searchInput.value.toLowerCase();
        const system = filterSelect.value;
        const filtered = allGames.filter(g =>
          g.title.toLowerCase().includes(search) &&
          (!system || g.system === system)
        );
        renderGames(filtered);
      }

      searchInput.addEventListener('input', updateList);
      filterSelect.addEventListener('change', updateList);

      renderGames(allGames);
    }

    init();
  </script>
</body>
</html>
